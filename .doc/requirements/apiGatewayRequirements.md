# api网关管理

## 一、	概述
提供所有微服务对外api的管理，包括API 创建、维护、发布、运行、下线等操作的全生命周期管理。同时提供可视化监控与交互式配置等服务。

## 二、	api网关管理功能点介绍
### 2.1	api生命周期管理
提供 API 创建、维护、上线、运行、下线等操作的全生命周期管理。

提供测试，预发布，发布等多种环境用以部署API 。

提供便捷的 API 日常管理，包括版本管理，版本回滚等。节约因 API 管理而造成的工作量与人力。

#### 2.1.1	创建api

​	用户选择创建api，进行api的初始创建，初始创建api需要填写以下信息：

> （1）api名称
>
> （2）状态：上线或下线，上线才可以接受用户请求
>
> （3）请求方法：外部请求来源方式，分为：ALL、GET、POST、PUT、DELETE
>
> （4）请求路径：外部用户的请求路径，可选择是否匹配所有子路径
>
> （5）请求参数：请求所用到的参数，包含参数名称、参数位置（head、parameter path等）、参数类型（string、int等）、默认值、示例、描述等



API 只有绑定路由策略，请求才能获得返回内容，因为路由策略内设置的地址为实际可返回结果地址，绑定之后网关将进行请求转发。可以选择已有的路由策略，或创建新的路由策略。

用户还可以进行以下设置

> （1）后端超时：定义请求的超时时间，访问此API处理时间超出设定时间后，系统将会阻止此请求的访问，避免请求持续占用资源；
>
> （2）网关缓存：开启缓存设置，程序端将会从您开始设置时间保存第一次请求API结果数据，后期同样的请求将从缓存区域返回请求结果，提高响应效率
>
> （3）熔断策略：用于对访问出现大量失败的 API 进行熔断控制，阻止请求对 API 的访问
>
> （4）跨域策略：绑定跨域策略后，访问此API 的请求如果属于跨域配置来之不同请求源、请求方式等，将不受限制的访问。
>
> （5）限流策略：可以绑定已有的限流策略
>
> （6）安全策略：可以绑定已有的安全策略
>
> （7）黑名单/白名单

####2.1.2	上线/下线api

在API调用或是API转发到的服务出现问题时，为了避免返回数据错误造成损失，可以将API点击下线，在完成修复后，可点击API上线，恢复调用。

####2.1.3	修改api

在API列表中可修改API，更改API的配置，生效到后续调用中。

#### 2.1.4	删除api

如果API不再使用，可以将API进行删除。

#### 2.1.5	api详情

在api详情页，可以查看api的详情



###2.2	认证与限流

限流功能可配置 API 的流控，用户可按业务需要配置每秒支持调用 API 的次数，用以保障用户业务的稳定性。

提供严格的认证服务，api调用者使用 API 网关提供的密钥进行认证，没有被授予密钥的客户端无法调用您的 API ，可保护用户API 的安全性。

#### 2.2.1	限流策略

限制API 在一段时间内的请求次数。

#### 2.2.2	认证服务

对请求进行安全校验，是否满足可以访问 API 的标准。

###2.3	api监控

提供可视化的监控信息。可方便的查询运行中 API 的详细信息。方便用户的运维管理。为用户对自身 API 的分析提供方便可靠的数据依据。以便 API 的后期迭代与维护，提高效率。

#### 2.3.1	流量统计

​	流量统计可查看一段时间内网关整体的请求转发情况，以统计表格的形式展现api的被调用情况

> （1）请求数：柱状图显示网关在一定时间内的总体请求数情况，体现总体请求的成功数，失败数以及平均响应时间
>
> （2）吞吐量：显示网关整体请求的平均吞吐量
>
> （3）错误率：显示网关整体请求的错误率
>
> （4）高频api：显示网关中被频繁调用的API（前5）；调用错误率最高的API（前5）；调用耗时最久的API（前5）；

#### 2.3.2	请求日志

​	显示API网关中API接口的请求日志信息，便捷查看相关错误信息。

> 包括请求的请求路径、状态码、请求耗时、消息和请求时间，以列表的形式呈现
>
> 可查看请求详情，详情还包括请求的id、调用地址、响应时间、源IP、请求头



### 2.4	跨域策略

### 2.5	路由策略

### 2.6	应用设置













## 三、与其他模块的关系
### 

## 四、	功能点分析

|            用户故事             | 功能点  |  M   |  S   |  C   |  W   | 约束 | 估时/人日 |
| :-----------------------------: | :-----: | :--: | :--: | :--: | :--: | :--: | :-------: |
| 作为用户，我希望能够创建查看api | 创建api |  Y   |      |      |      |      |     2     |
|                                 | 查看api |  Y   |      |      |      |      |     1     |
|                                 | 删除api |  Y   |      |      |      |      |     1     |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
|                                 |         |      |      |      |      |      |           |
