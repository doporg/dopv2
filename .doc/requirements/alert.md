#告警模块

## 历史版本
| 版本 | 修改内容 | 修改人 | 修改日期   |
| ---- | -------- | ------ | ---------- |
| v1.0 | 初始版本 | 洪铨健 | 2020-02-12 |
| v1.5 | 详细需求版本 | 洪铨健 | 2020-02-15 |



## 一、	概述

​	微服务的架构成为如今软件开发的主流，应用会被拆分成多个微服务，导致监控数据的爆炸增长，运维人员无法快速处理和展示这些监控数据。如果我们不能进行有效的实时监控，及时的处理，经常会带来巨大损失。为了保证异常的即使处理，我们设计一套系统，对产生的日志进行实时的监控报警，当出现异常或者指定的信息的时候，给我们的对应工作人员发送邮件和短信提醒，同时记录异常的信息。做到线上异常的实时监控。




## 二、	告警模块功能点介绍
### 2.1	告警策略管理

​	告警策略管理是告警模块的核心部分，通过对告警规则的设置，模块能够对告警对象按照规则进行实时监控告警。

​	点击菜单栏的告警图标，可以进入告警管理界面。在告警管理界面，点击第二菜单栏的“告警设置”选项，进入告警设置页面。在这个页面，用户可以创建新的告警策略，查看，修改和删除已有的告警策略。

​	当触发规则时，系统会自动对告警联系人发送提醒。电话会通过语音告知警告，短信和邮箱会告知告警所在的产品和告警规则并附上链接，跳转至告警日志显示告警的信息。

#### 2.1.1	创建新告警策略
当点击”创建告警策略”按钮，会进入添加告警规则页面，需要根据以下步骤配置告警规则：

>（1）在''基本信息“一栏，填写新增告警规则名和描述，选择状态和告警级别
>（2）在''告警规则“一栏，添加若干条规则，每个规则需选择一个指标参数和条件，设定阈值，统计周期和重复次数
>（3）在''告警对象“一栏，在实例列表中选着相应的产品与实例应用于该告警规则
>（4）在''告警通知“一栏，加入相应的接受告警的用户账号，选择通知方式和通知频率。通知方式可以选择电话或短信加邮箱或邮箱通知。
>（5）在''确认信息“一栏，对新建的告警规则进行确认，点击确认创建，创建新的告警策略

#### 2.1.2	查看告警策略

​	在告警设置页面，可以通过搜索框选择对规则名称，描述，或产品名称进行文字匹配搜索。告警级别一栏，可以下拉勾选级别来筛选告警策略。状态栏，可以下拉勾选状态来筛选告警策略。

#### 2.1.3	修改和删除告警策略
​	在告警设置页面，可以对已配置的告警规则进行操作，点击告警规则操作一列的“…”键，可以选择修改和删除该告警规则。点击修该规则会进入与创建告警规则时一样的界面，可以对已设置的规则，状态，对象等属性进行修改



### 2.2	告警日志管理

​	在告警管理界面，点击第二菜单栏的“告警历史”选项，进入告警日志页面。在这个页面，会显示告警的历史，每一次告警的数据，告警规则，超额指标，发生时间，持续时间，产品类型，故障资源，告警对象，状态等。

​	点击每一条告警日志会进入日志信息的界面，显示更多的详细信息（超过阈值的参数数值，时间折线图），处理方式（不确定），每一条告警日志处理之后状态会自动发生更改，从未处理转到已处理状态。

​	在告警日志页面，默认按照时间顺序排序。用户能够根据时间，产品名或规则名称来对告警日志进行筛选，搜索。状态栏，可以下拉勾选状态来筛选告警策略。每一条告警日志可以进行删除操作。



### 2.3	告警联系人管理

​	在告警管理界面，点击第二菜单栏的“告警联系人”选项，进入告警联系人管理页面。在这个页面，可以创建新的告警联系人，修改和删除已有的告警联系人。



#### 2.3.1	新建告警联系人

​	点击新建联系人按钮，会进入新建联系人窗口，需要填写联系人姓名，电话，邮箱

#### 2.3.1	查看告警联系人

​	可以通过搜索框对联系人姓名，电话，邮箱进行搜索

####2.3.1	修改和删除告警联系人

​	在告警联系人页面，可以对告警联系人行操作，点击告警联系人操作一列的“…”键，可以选择修改和删除该告警联系人。点击修改会进入与创建告警联系人一样的界面，可以对已设置的联系人姓名，电话，邮箱进行修改。点击批量删除按钮可以快速删除选择的告警联系人



## 三、与其他模块的关系

### 3.1	用户管理、组织层级、权限管理
​	告警模块需要调用用户及其组织信息，项目信息。组织、项目的管理人员有权对相应项目的告警规则进行设置。



### 3.3	监控模块

​	告警模块需要调用监控模块的所有数据，对数据进行分析，告警。

​	CPU使用率，内存使用率，硬盘使用，IOPS使用率，连接数使用率

​	对于数据库来说：CPU使用率，网络带宽大小，db请求数，db响应数，db错误响应数，db请求延迟，db请求数的绝对量，db正确响应相对请求数的占比

​	



## 四、	功能点分析
| 用户故事                               | 功能点         | M    | S    | C    | W    | 约束               | 估时/人日 |
| -------------------------------------- | -------------- | ---- | ---- | ---- | ---- | ------------------ | --------- |
| 作为用户，我希望能够创建查看告警策略   | 创建告警策略   | Y    |      |      |      | 用户管理、权限管理 | 3         |
|                                        | 查看告警策略   | Y    |      |      |      |                    | 3         |
|                                        | 删除告警策略   |      |      | Y    |      |                    | 1         |
| 作为用户，我希望能够编辑告警策略       | 修改告警策略   | Y    |      |      |      | 用户管理、权限管理 | 2         |
| 作为用户，我希望能够查看告警日志       | 查看告警日志   | Y    |      |      |      |                    | 2         |
|                                        | 搜索告警日志   |      |      | Y    |      |                    | 2         |
| 作为用户，我希望能够删除告警日志       | 删除告警日志   |      |      | Y    |      | 用户管理           | 1         |
| 作为用户，我希望能够创建查看告警联系人 | 创建告警联系人 | Y    |      |      |      | 用户管理、权限管理 | 3         |
|                                        | 查看告警联系人 | Y    |      |      |      |                    | 1         |
|                                        | 删除告警联系人 |      |      | Y    |      | 用户管理           | 1         |
| 作为用户，我希望能够编辑告警联系人     | 修改告警联系人 | Y    |      |      |      | 用户管理、权限管理 | 2         |

